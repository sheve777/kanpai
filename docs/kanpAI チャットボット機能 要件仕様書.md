# kanpAI チャットボット機能 要件仕様書

## 基本コンセプト

kanpAIチャットボットは居酒屋の「第二の従業員」として、LINE上でお客様の問い合わせに24時間自動対応します。ただし、営業時間外はトークン消費を避けるため、予約機能以外は停止します。

---

## 対応機能・サービス範囲

### ✅ 対応すること
- **メニュー案内**: 料理名、価格、説明、カテゴリ別案内
- **よくある質問**: 営業時間、アクセス、支払い方法、店舗情報
- **予約受付**: 日時、人数、席種の予約（24時間対応）
- **おすすめ案内**: 店主設定のおすすめメニュー紹介
- **基本的な雑談**: 挨拶、お礼など自然な会話

### ❌ 対応しないこと
- **注文受付**: 実際の料理注文は受け付けない
- **会計処理**: 支払い・決済は対応しない
- **在庫管理**: リアルタイム在庫確認はしない
- **クレーム対応**: 苦情は店主へ誘導
- **医療・健康相談**: 専門的な相談は対応しない

---

## 営業時間・対応時間

### 営業時間内（チャットボットフル稼働）
- **対応内容**: 全機能利用可能
- **応答時間**: 3-5秒以内
- **人格**: 店舗設定に応じた親しみやすい対応

### 営業時間外（機能制限）
- **対応内容**: 予約受付のみ
- **その他の質問**: 「営業時間外です。◯時から営業しております」で応答
- **トークン消費**: 最小限に抑制

---

## 会話・履歴管理

### セッション管理
- **セッション開始**: 初回メッセージ送信時
- **セッション継続**: 最後のやりとりから1時間以内
- **セッション終了**: 1時間無応答で自動終了

### 会話履歴保持
- **保持期間**: セッション中のみ（最大1時間）
- **保持範囲**: 直近2-3回のやりとりを記憶
- **保持方法**: 
  - メニュー検索結果: そのまま保持（「さっきの焼き鳥で〜」に対応）
  - 会話文脈: 要約して保持（「辛いのが好み」「予算3000円以下」など）

### 会話の自然さ
- **前回参照**: 「さっきの焼き鳥の中で一番辛いのは？」に対応
- **好み記憶**: セッション中の好み・条件を一時記憶
- **文脈理解**: 省略された主語を補完

---

## エラー・例外処理

### 理解できない質問
- **対応**: 「申し訳ございません。マスター（店主）にお聞きください」
- **誘導**: 店舗電話番号・営業時間を案内
- **ログ**: エラー内容を記録し、FAQ改善に活用

### 重要情報（アレルギー・成分）
- **対応**: 「アレルギーについては安全のため、直接お店にお問い合わせください」
- **理由**: 間違った情報提供のリスク回避
- **案内**: 店舗電話番号を必ず併記

### API制限・使用量超過
- **お客様向け**: 親しみやすい「充電切れ」表現で店主への依頼を誘導
- **応答例**: 「今月はもうチャットボットの充電が切れちゃいました😅 マスターに『充電お願いします！』って言ってもらえますか？」
- **仕組み**: お客様→店主への従量課金依頼を自然に誘導
- **継続性**: サービス停止を避ける仕組み

---

## プラン別機能制限

### 使用量制限
- **エントリープラン**: 月300ポイント（約3,000円分）
- **スタンダードプラン**: 月1,000ポイント（約10,000円分）
- **プロプラン**: 月3,000ポイント（約30,000円分）

### 制限到達時の対応
1. **80%到達**: 店主にアラート送信
2. **95%到達**: 店主に緊急通知
3. **100%到達**: 
   - 親しみやすい「充電切れ」表現でお客様に案内
   - 基本案内（営業時間・電話番号）のみ継続
   - 予約機能は維持

### 使用量超過時の応答例
```
【親しみやすい店舗】
「あー！ごめんなさい！
今月はもうチャットボットの充電が切れちゃいました😅
マスターに『充電お願いします！』って言ってもらえますか？」

【丁寧な店舗】
「申し訳ございません。
今月のチャットボット利用上限に達してしまいました。
マスターに『追加利用をお願いします』とお伝えください。」

【カジュアルな店舗】
「おっと〜！チャットボットのエネルギー切れだ⚡
マスターに『パワーアップして〜』って頼んでくれる？」
```

---

## チャットボット人格設定

### 基本人格（店舗ごと設定可能）
- **話し方**: 丁寧語・親しみやすい・カジュアル
- **一人称**: 「私」「僕」「店名」など
- **挨拶**: 店舗オリジナルの挨拶・決まり文句
- **特徴的表現**: 店舗らしい表現・方言・キャラクター性

### 応答パターン例
```
【丁寧パターン】
「いらっしゃいませ！本日はありがとうございます。メニューのご案内をさせていただきますね。」

【親しみやすいパターン】
「いらっしゃいませ〜！今日もお疲れ様です♪ どんなメニューがお気になりですか？」

【カジュアルパターン】
「よっ！お疲れ！今日は何食べる？おすすめあるよ〜」
```

---

## メニュー案内機能

### 検索機能
- **カテゴリ検索**: 「焼き鳥」「ドリンク」「一品料理」など
- **価格帯検索**: 「1000円以下」「予算3000円」など
- **キーワード検索**: 「辛い」「さっぱり」「ビール」など
- **おすすめ検索**: 店主設定のおすすめメニュー

### 表示情報
- **必須情報**: 料理名、価格
- **詳細情報**: 説明文、特徴
- **注意情報**: アレルギーは「店主に確認」誘導

### 表示形式
```
🔥 人気の焼き鳥メニュー 🔥

【鶏もも】150円
ジューシーで柔らかい定番の一品

【ねぎま】160円  
ネギの甘みと鶏肉の旨味が絶妙

【つくね】180円
手作りつくねに特製タレ

他にもたくさんあります♪
詳しくはお気軽にお聞きください！
```

---

## 予約受付機能

### 受付条件
- **期間**: 当日不可、翌日以降のみ
- **時間**: 30分刻み、営業時間内のみ
- **人数**: 1名〜店舗設定上限
- **席種**: カウンター・テーブル・個室（店舗ごと設定）

### 必要情報
- **お名前**: フルネーム
- **人数**: 正確な人数
- **希望日時**: 第一希望（第二希望は店主判断）
- **電話番号**: 連絡先
- **席種**: 空きがあれば選択可能

### 予約フロー
1. **空き確認**: Googleカレンダーと照合
2. **情報入力**: 必要項目の入力誘導
3. **内容確認**: 入力内容の最終確認
4. **予約確定**: 自動でGoogleカレンダーに追加
5. **確認通知**: お客様・店主両方に通知

---

## データ活用・分析

### 会話ログの活用
- **よく聞かれる質問**: FAQ改善・メニュー説明強化
- **人気メニュー**: 検索回数・言及回数の集計
- **時間帯分析**: 利用時間帯の傾向把握
- **対応品質**: エラー率・顧客満足度の推測

### プライバシー保護
- **個人情報**: 名前・電話番号は分析用データから除外
- **匿名化**: 店舗特定情報を除いた分析
- **保存期間**: 個人情報は3ヶ月、分析データは永続

---

## 成功指標・KPI

### 基本指標
- **応答率**: 95%以上（エラー率5%以下）
- **応答時間**: 平均5秒以内
- **セッション継続率**: 1セッション平均3回以上のやりとり

### ビジネス指標
- **予約転換率**: チャット利用者の予約率
- **メニュー案内効果**: 案内後の注文率
- **店主業務軽減**: 電話問い合わせの減少率

### 顧客満足度
- **自然な会話**: 「ロボットっぽくない」応答
- **有用な情報**: 「欲しい情報が得られた」
- **スムーズな予約**: 「簡単に予約できた」