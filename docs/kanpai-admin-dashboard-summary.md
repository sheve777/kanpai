# kanpAI 管理者ダッシュボード 実装計画まとめ

## 📋 プロジェクト概要

### 目的
kanpAIサービスの運営者（あなた専用）が、全店舗を一元管理できる管理者向けダッシュボードを構築する。

### 基本方針
- **ローカル運用**（セキュリティ最優先）
- **2台体制**（デスクトップ＋ノートPC）
- **新店舗追加も管理画面で完結**

---

## 🎯 主要機能一覧

### 1. ダッシュボード（トップページ）
- 📊 全店舗の統計サマリー
- ⚠️ リアルタイムアラート表示
- 📅 今日のタスク一覧
- 📈 利用推移グラフ

### 2. 店舗管理機能
- 🏪 店舗一覧（フィルター・検索機能付き）
- 📝 個別店舗詳細（タブ切り替え式）
- ➕ **新店舗追加ウィザード**
- 🔐 **環境変数管理**（.env情報の安全な編集）

### 3. レポート管理
- 📊 月次レポートの一括生成
- ✏️ AI生成レポートの編集
- 📤 配信管理

### 4. 収益管理
- 💰 MRR推移・収益分析
- 📋 請求管理
- 📈 プラン別分析

### 5. システム監視
- 🔍 API使用状況
- ⚡ パフォーマンス監視
- 🚨 エラーログ確認

---

## 🆕 新店舗追加機能の詳細

### ウィザード形式（5ステップ）
1. **基本情報** → 店舗名、住所、営業時間など
2. **LINE設定** → Channel ID/Secret/Token入力、接続テスト
3. **Google連携** → カレンダー認証、予約設定
4. **AI設定** → チャットボット人格、トーン設定
5. **初期データ** → メニューCSVアップロード

### 環境変数の一元管理
```
┌─────────────────────────────────────┐
│ 🔐 店舗環境設定                      │
├─────────────────────────────────────┤
│ LINE_CHANNEL_ID: [表示/編集]        │
│ LINE_SECRET: [●●●●] [表示]          │
│ GOOGLE_CLIENT_ID: [表示/編集]       │
│ ※暗号化保存・操作ログ記録          │
└─────────────────────────────────────┘
```

---

## 🔒 セキュリティ設計

### 多層防御アプローチ
1. **ローカルアクセスのみ**（最強のセキュリティ）
2. **店舗名確認**（重要操作時）
3. **操作ログ完全記録**
4. **暗号化保存**（環境変数）

### 重要操作の確認フロー
```
通常操作 → そのまま実行
重要操作 → 店舗名入力で確認
超重要操作 → 店舗名＋理由入力＋確認ダイアログ
```

---

## 💻 システム構成

### デプロイ構成
```yaml
管理画面: localhost:3001（ローカルPC）
本番API: https://api.kanpai.jp（クラウド）
接続方法: ローカル → API（管理者APIキー認証）
```

### 2台運用体制
```yaml
デスクトップ（自宅）:
  - 日常の管理業務
  - 開発作業
  - 大画面で効率的

ノートPC（店舗訪問用）:
  - 店舗での打ち合わせ
  - 実機デモ
  - 初期設定サポート
  - BitLocker暗号化
```

---

## 🗄️ データベース拡張

### 追加テーブル
```sql
-- 管理者認証
admin_users

-- 操作履歴
admin_activity_logs

-- 店舗認証情報（暗号化）
store_credentials

-- セットアップ進捗
store_setup_progress

-- サポートチケット
support_tickets
```

---

## 🚀 実装計画

### Phase 1: MVP（2-3週間）
- ✅ ローカル環境構築
- ✅ 基本的な店舗一覧・詳細表示
- ✅ 新店舗追加ウィザード
- ✅ 環境変数管理機能
- ✅ 基本的なダッシュボード

### Phase 2: 運用効率化（2週間）
- 📊 レポート一括管理
- 💰 収益管理ダッシュボード
- 🔔 アラート・通知機能

### Phase 3: 高度な機能（2週間）
- 💬 サポートチケット管理
- 📈 詳細な分析機能
- 🤖 自動化ツール

---

## 🎨 UI/UXデザイン

### デザイン方針
- **昭和モダンテイスト**（レトロと現代の融合）
- **居酒屋らしい温かみ**（提灯、暖簾のモチーフ）
- **視認性重視**（ステータスを色と絵文字で表現）
- **レスポンシブ対応**（将来のタブレット利用も考慮）

### カラーパレット
```css
/* 昭和モダンカラー */
--primary: #8B4513;      /* 茶色（木目調） */
--secondary: #DC143C;    /* 提灯の赤 */
--accent: #FFD700;       /* 金色（高級感） */
--bg-dark: #2C1810;      /* 濃い茶色 */
--bg-light: #F5DEB3;     /* 和紙のような色 */
--text-primary: #3E2723; /* 墨色 */
```

### 画面構成
```
┌─────────────────────────────────┐
│ 🏮 kanpAI 管理処  👤 🔔 ⚙️      │
├──────┬──────────────────────────┤
│ 📊   │                          │
│ 🏪   │    メインコンテンツ       │
│ 📈   │   （和紙テクスチャ背景）  │
│ 💰   │                          │
└──────┴──────────────────────────┘
```

---

## 📁 ファイル構成

```
C:\Users\acmsh\kanpAI\        # 既存のkanpAIプロジェクト
├── backend/                  # 既存のバックエンド
├── frontend/                 # 既存のフロントエンド
├── docs/                     # ドキュメント
└── admin/                    # 管理画面（新規追加）
    ├── src/
    │   ├── components/       # UIコンポーネント
    │   ├── pages/           # 各画面
    │   └── services/        # API通信
    └── .env.local           # ローカル設定
```

---

## 🔧 開発環境セットアップ

### 初回セットアップ
```bash
# 管理画面用ディレクトリ作成
cd C:\Users\acmsh\kanpAI
mkdir admin
cd admin

# Reactプロジェクト作成
npx create-react-app . --template typescript
# または
npm init vite@latest . -- --template react-ts

# 必要なパッケージインストール
npm install axios react-router-dom recharts
npm install -D @types/react @types/react-dom
```

### 起動スクリプト
```batch
@echo off
REM start-admin.bat
cd /d C:\Users\acmsh\kanpAI\admin
start npm run dev
timeout /t 5
start http://localhost:5173
```

---

## ✅ 決定事項まとめ

1. **完全ローカル運用**で最高のセキュリティ
2. **2台体制**で効率と可用性を両立
3. **新店舗追加機能**で運用を完全自動化
4. **環境変数管理**を安全に実装
5. **段階的実装**でリスクを最小化

---

## 🎯 次のアクション

1. **管理画面プロジェクトの作成**
2. **基本的なルーティング設定**
3. **店舗一覧画面の実装**
4. **本番APIとの接続テスト**
5. **新店舗追加ウィザードの構築**

---

*このまとめは、kanpAI管理者ダッシュボードの実装における全決定事項を網羅しています。この計画に基づいて、セキュアで効率的な管理システムを構築できます。*